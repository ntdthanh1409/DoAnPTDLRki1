d = 0
e = 0
for (i in df_4){
if (i <= 100){
a = a +1
} else if (100 <i & i <= 300){
b = b + 1
} else if (i > 300 & i <= 500){
c = c + 1
} else if (i > 500 & i <= 1000){
d = d + 1
} else{
e = e + 1
}
}
data <- c(a,b,c,d,e)
heart <- data.frame(data)
heart
heart<- c(a,b,c,d,e)
heart <- data.frame(data)
heart
heart <- data.frame(heart)
heart
heart<- c(a,b,c,d,e)
heart <- data.frame(heart)
heart
ggplot(data = heart, mapping = aes(x = heart))+
geom_histogram()
ggplot(data = data$heart, mapping = aes(x = heart))+
geom_histogram()
ggplot(data = data, mapping = aes(x = heart))+
geom_histogram()
ggplot(data = data, mapping = aes(x = data$heart))+
geom_histogram()
data <- read.csv('1.csv', header = TRUE, encoding = 'UTF-8')
ggplot(data = data, mapping = aes(x = data$heart))+
geom_histogram()
ggplot(data = data, mapping = aes(x = heart))+
geom_histogram()
ggplot(data = data, mapping = aes(x = heart))+
geom_histogram()
ggplot(data = data, mapping = aes(x = heart), color = 'red')+
geom_histogram()
ggplot(data = data, mapping = aes(x = heart))+
geom_histogram(color = 'red')
ggplot(data = data, mapping = aes(x = heart))+
geom_histogram(color = 'red',
fill = "blue",
alpha = 0.1)
ggplot(data = data, mapping = aes(x = heart))+
geom_histogram(color = 'red',
fill = "blue",
binwidth = 7,
alpha = 0.1)
ggplot(data = data, mapping = aes(x = heart))+
geom_histogram(color = 'red',
fill = "blue",
binwidth = 20,
alpha = 0.1)
ggplot(data = data, mapping = aes(x = heart))+
geom_histogram(color = 'black',
fill = "blue",
binwidth = 20,
alpha = 0.1)
ggplot(data = data, mapping = aes(x = heart))+
geom_histogram(color = 'black',
fill = "blue",
binwidth = 30,
alpha = 0.1)
ggplot(data = data, mapping = aes(x = heart))+
geom_histogram(color = 'black',
fill = "blue",
binwidth = 3,
alpha = 0.1)
ggplot(data = data, mapping = aes(x = heart))+
geom_histogram(color = 'black',
fill = "blue",
binwidth = 3,
alpha = 0.5)
ggplot(data = data, mapping = aes(x = heart))+
geom_histogram(color = 'black',
fill = "red",
binwidth = 20,
alpha = 1)
ggplot(data = data, mapping = aes(x = heart))+
geom_histogram(color = 'black',
fill = "red",
binwidth = 20)
ggplot(data = data, mapping = aes(x = heart))+
geom_histogram(color = 'black',
fill = "red"
)
ggplot(data = data, mapping = aes(x = heart))+
geom_histogram(color = 'black',
fill = "red", binwidth = 3
)
ggplot(data = data, mapping = aes(x = heart))+
geom_histogram(color = 'black',
fill = "red", binwidth = 50
)
ggplot(data = data, mapping = aes(x = heart))+
geom_histogram(color = 'black',
fill = "red", binwidth = 200
)
ggplot(data = data, mapping = aes(x = heart))+
geom_histogram(color = 'black',
fill = "red", binwidth = 200, alpha = 0,1
)
ggplot(data = data, mapping = aes(x = heart))+
geom_histogram(color = 'black',
fill = "red", binwidth = 200, alpha = 0,5)
ggplot(data_2, aes(x= a)) +
geom_line(aes(y = Percent_3), color = "black") +
geom_line(aes(y = Percent_4), color="red") +
labs(title = 'BIEU DO VE TI LE LUOT THEO DOI VA LUOT XEM', x = 'Type', y = 'Percent')
ggplot(data_3, aes(x= a)) +
geom_line(aes(y = Percent_3), color = "black") +
geom_line(aes(y = Percent_4), color="red") +
labs(title = 'BIEU DO VE TI LE LUOT THEO DOI VA LUOT XEM', x = 'Type', y = 'Percent')
data_3 <- data.frame(data_2, Percent_4)
data_3
ggplot(data_3, aes(x= a)) +
geom_line(aes(y = Percent_3), color = "black") +
geom_line(aes(y = Percent_4), color="red") +
labs(title = 'BIEU DO VE TI LE LUOT THEO DOI VA LUOT XEM', x = 'Type', y = 'Percent')
ggplot(data = data, mapping = aes(x = heart))+
geom_histogram(color = 'black',
fill = "red", binwidth = 200, alpha = 0,5)
ggplot(data = data, mapping = aes(x = heart)) +
geom_histogram(color = 'black',
fill = "red", binwidth = 200, alpha = 0,5)
data <- read.csv('1.csv', header = TRUE, encoding = 'UTF-8')
ggplot(data = data, mapping = aes(x = heart)) +
geom_histogram(color = 'black',
fill = "red", binwidth = 200, alpha = 0,5)
data <- read.csv('1.csv', header = TRUE, encoding = 'UTF-8')
library('ggplot2')
ggplot(data = data, mapping = aes(x = heart)) +
geom_histogram(color = 'black',
fill = "red", binwidth = 200, alpha = 0,5)
ggplot(data = data, mapping = aes(x = heart)) +
geom_histogram(color = 'black',
fill = "red", binwidth = 200)
ggplot(data = data, mapping = aes(x = heart)) +
geom_histogram(color = 'black',
fill = "red", binwidth = 100)
ggplot(data = data, mapping = aes(x = heart)) +
geom_histogram(color = 'black',
fill = "red", binwidth = 300)
ggplot(data = data, mapping = aes(x = heart)) +
geom_histogram(color = 'black',
fill = "red", binwidth = 300) +
labs(title = 'BIEU DO VE VE HEART', x = 'So luot theo doi')
library(ggplot2)
library(plotly)
library(gapminder)
library(tidyverse)
library(e1071)
library(viridis)
library(hrbrthemes)
library(dplyr)
library(plyr)
library(readr)
library(ggthemes)
library(car)
library('stringr')
install.packages("e1071")
install.packages("ggthemes")
install.packages("viridis")
install.packages("car")
install.packages("plotly")
install.packages("gapminde")
library(ggplot2)
library(plotly)
library(gapminder)
library(tidyverse)
library(e1071)
library(viridis)
library(hrbrthemes)
library(dplyr)
library(plyr)
library(readr)
library(ggthemes)
library(car)
library('stringr')
install.packages("gapminder")
library('ggplot2')
library('plotly')
library('ggplot2')
library('stringr')
data <- read.csv('Lnfix.csv', header = TRUE, encoding = 'UTF-8')
nrow(data)
head(data, 20)
names(data)
gernes <- c('Action', 'Adapted to Anime', 'Adapted to Manga',
'Adult', 'Adventure', 'Comedy', 'Cooking', 'Drama', 'Ecchi', 'Fantasy', 'Game', 'Gender Bender', 'Harem', 'Historical',
'Horror', 'Incest', 'Isekai', 'Josei', 'Korean Novel', 'Magic', 'Martial Arts', 'Mature', 'Mecha', 'Military',
'Mystery', 'One shot', 'Otome Game', 'Psychological', 'Reverse Harem', 'Romance', 'School Life',
'Science Fiction', 'Seinen', 'Shoujo', 'Shoujo ai', 'Shounen', 'Shounen ai', 'Slice of Life', 'Sports',
'Super Power', 'Supernatural', 'Tragedy', 'Web Novel', 'Yuri')
gernes_count <- c(939, 64, 203, 105, 831, 1022, 22, 621, 327, 1187,
58, 86, 615, 43, 87, 17, 332, 45, 131, 213, 64, 182, 44, 43, 200,
74, 31, 210, 6, 1182, 508, 117, 211, 144, 75, 271, 8, 526, 3, 156, 335, 209, 564, 53)
data_1 <- data.frame(gernes, gernes_count)
# Plot 1: Bieu do ve the loai va so luong truyen co the loai do
ggplot(data_1, aes(x = gernes, y= gernes_count)) +
geom_bar(stat = "identity") +
labs( title = 'BIEU DO VE THE LOAI VA SO LUONG TRUYEN CO THE LOAI DO',
x = 'THE LOAI', y = 'SO LUONG') +
coord_flip()
df_2 <- data$words
x <- c()
for (i in df_2){
if (i <= 30000){
x <- append(x, 'Low')
} else if (30000 < i & i <= 70000){
x <- append(x, 'Medium')
} else if (i > 70000 & i <= 150000){
x <- append(x, "High")
} else if (i > 150000 & i <= 250000){
x <- append(x, "Super_High")
} else{
x <- append(x, "Mega_High")
}
}
Type_words <- x
a = 0
b = 0
c = 0
d = 0
e = 0
for (i in Type_words){
if (i == "Low"){
a = a +1
} else if (i == "Medium"){
b = b + 1
} else if (i == 'High'){
c = c + 1
} else if (i == 'Super_High'){
d = d + 1
} else{
e = e + 1
}
}
sum <- a + b + c + d + e
a <- round((a/sum)*100,2)
b <- round((b/sum)*100,2)
c <- round((c/sum)*100,2)
d <- round((d/sum)*100,2)
e <- round((e/sum)*100,2)
Percent_2 <- c(a,b,c,d,e)
Type <- c('Low', 'Medium', 'High', 'Super_High', 'Mega_High')
df_3 <- data$view
a = 0
b = 0
c = 0
d = 0
e = 0
for (i in df_3){
if (i <= 50000){
a = a +1
} else if (50000 <i & i <= 150000){
b = b + 1
} else if (i > 150000 & i <= 250000){
c = c + 1
} else if (i > 250000 & i <= 350000){
d = d + 1
} else{
e = e + 1
}
}
sum <- a + b + c + d + e
a <- round((a/sum)*100,2)
b <- round((b/sum)*100,2)
c <- round((c/sum)*100,2)
d <- round((d/sum)*100,2)
e <- round((e/sum)*100,2)
Percent_3 <- c(a,b,c,d,e)
a <-c(1,2,3,4,5)
data_2 <- data.frame(Type, a, Percent_2, Percent_3)
data_2
ggplot(data_2, aes(x= a)) +
geom_line(aes(y = Percent_2), color = "red") +
labs(title = 'BIEU DO VE TI LE SO TU', x = 'Type', y = 'Percent')
ggplot(data_2, aes(x= a)) +
geom_line(aes(y = Percent_2), color = "red") +
labs(title = 'BIEU DO VE TI LE SO CHU', x = 'Type', y = 'Percent')
ggplot(data = data, mapping = aes(x = heart)) +
geom_histogram(color = 'black',
fill = "red", binwidth = 300) +
labs(title = 'BIEU DO VE VE HEART', x = 'So luot theo doi')
# ham tinh mode (yeu vi)
getmode <- function(v) {
uniqv <- unique(v)
uniqv[which.max(tabulate(match(v, uniqv)))]
}
# Tinh mean, mode, median cua heart (luot theo doi)
df_heart <-data$heart
mean(df_heart)
median(df_heart)
getmode(df_heart)
# tinh mean, mode, median cua star (danh gia)
df_star <- data$star
mean(df_star)
getmode(df_star)
median(df_star)
# tinh mean, mode, median cua view (so luot xem)
df_view <- data$view
mean(df_view)
getmode(df_view)
median(df_view)
# tinh mean, mode, median cua words (so luong tu)
df_words <- data$words
mean(df_words)
getmode(df_words)
median(df_words)
# tong quan ve du lieu
summary(data)
ggplot(data_2, aes(x= a)) +
geom_line(aes(y = Percent_2), color = "red") +
labs(title = 'BIEU DO VE TI LE SO TU', x = 'Type', y = 'Percent')
data_2
ggplot(data_2, aes(x= a)) +
geom_line(aes(y = Percent_2), color = "red") +
labs(title = 'BIEU DO VE TI LE SO TU', x = 'Type', y = 'Percent')
ggplot(data_2, aes(x= a)) +
geom_line(aes(y = Percent_3), color = "red") +
labs(title = 'BIEU DO VE TI LE SO CHU', x = 'Type', y = 'Percent')
ggplot(data_2, aes(x= a)) +
geom_line(aes(y = Percent_3), color = "red") +
labs(title = 'BIEU DO VE TI LE SO LUOT XEM', x = 'Type', y = 'Percent')
ggplot(data = data, mapping = aes(x = heart)) +
geom_histogram(color = 'black',
fill = "red", binwidth = 300) +
labs(title = 'BIEU DO VE VE HEART', x = 'So luot theo doi')
# import library
library('ggplot2')
library('stringr')
# import csv file
data <- read.csv('Lnfix.csv', header = TRUE, encoding = 'UTF-8')
## Task 1: Mo ta du lieu lay ve
# a. So luong dong du lieu
nrow(data)
#b. Danh sach cac truong du lieu
# Xem 20 dong dau tien
head(data, 20)
# Ten cac truong du lieu
names(data)
# danh sach cac truong cua du lieu
str(data)
View(data)
## Task 2: Thong ke mo ta
# a. Tinh cac chi so thong ke co ban
# ham tinh mode (yeu vi)
getmode <- function(v) {
uniqv <- unique(v)
uniqv[which.max(tabulate(match(v, uniqv)))]
}
# Tinh mean, mode, median cua heart (luot theo doi)
df_heart <-data$heart
mean(df_heart)
median(df_heart)
getmode(df_heart)
# tinh mean, mode, median cua star (danh gia)
df_star <- data$star
mean(df_star)
getmode(df_star)
median(df_star)
# tinh mean, mode, median cua view (so luot xem)
df_view <- data$view
mean(df_view)
getmode(df_view)
median(df_view)
# tinh mean, mode, median cua words (so luong tu)
df_words <- data$words
mean(df_words)
getmode(df_words)
median(df_words)
# tong quan ve du lieu
summary(data)
# b. Ve bieu do
# hàm dem so luong cua moi the loai
number_gerne <- function(y){
count = 0
df_1 <- data$gernes
for (i in df_1){
A = FALSE
t = strsplit(i, ',') # tach thanh cac chuoi
for (x in t){
x <- str_trim(x)  # xoa khoang trang dau cuoi
if (y %in% x){
A = TRUE
}
}
if (A == TRUE){
count = count + 1
}
}
return (count)
}
number_gerne('Romance')
# ham lay ra cac the loai
#gerne <- character()
#df_2 <- data$gernes[1:2]
#for (i in df_2){
#t = strsplit(i, ',')
#for (x in t){
#x <- str_trim(x)
#a <- c(x)
#b <- c(gerne, a)
#}
#}
gernes <- c('Action', 'Adapted to Anime', 'Adapted to Manga',
'Adult', 'Adventure', 'Comedy', 'Cooking', 'Drama', 'Ecchi', 'Fantasy', 'Game', 'Gender Bender', 'Harem', 'Historical',
'Horror', 'Incest', 'Isekai', 'Josei', 'Korean Novel', 'Magic', 'Martial Arts', 'Mature', 'Mecha', 'Military',
'Mystery', 'One shot', 'Otome Game', 'Psychological', 'Reverse Harem', 'Romance', 'School Life',
'Science Fiction', 'Seinen', 'Shoujo', 'Shoujo ai', 'Shounen', 'Shounen ai', 'Slice of Life', 'Sports',
'Super Power', 'Supernatural', 'Tragedy', 'Web Novel', 'Yuri')
gernes_count <- c(939, 64, 203, 105, 831, 1022, 22, 621, 327, 1187,
58, 86, 615, 43, 87, 17, 332, 45, 131, 213, 64, 182, 44, 43, 200,
74, 31, 210, 6, 1182, 508, 117, 211, 144, 75, 271, 8, 526, 3, 156, 335, 209, 564, 53)
data_1 <- data.frame(gernes, gernes_count)
# Plot 1: Bieu do ve the loai va so luong truyen co the loai do
ggplot(data_1, aes(x = gernes, y= gernes_count)) +
geom_bar(stat = "identity", fill="blue", alpha=.5, width=.5) +
labs( title = 'BIEU DO VE THE LOAI VA SO LUONG TRUYEN CO THE LOAI DO',
x = 'THE LOAI', y = 'SO LUONG') +
coord_flip() +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5),
panel.background = element_rect(fill = 'white'),
panel.border = element_rect(colour = '#990000', size = 1.5))
df_2 <- data$words
x <- c()
for (i in df_2){
if (i <= 30000){
x <- append(x, 'Low')
} else if (30000 < i & i <= 70000){
x <- append(x, 'Medium')
} else if (i > 70000 & i <= 150000){
x <- append(x, "High")
} else if (i > 150000 & i <= 250000){
x <- append(x, "Super_High")
} else{
x <- append(x, "Mega_High")
}
}
Type_words <- x
a = 0
b = 0
c = 0
d = 0
e = 0
for (i in Type_words){
if (i == "Low"){
a = a +1
} else if (i == "Medium"){
b = b + 1
} else if (i == 'High'){
c = c + 1
} else if (i == 'Super_High'){
d = d + 1
} else{
e = e + 1
}
}
sum <- a + b + c + d + e
a <- round((a/sum)*100,2)
b <- round((b/sum)*100,2)
c <- round((c/sum)*100,2)
d <- round((d/sum)*100,2)
e <- round((e/sum)*100,2)
Percent_2 <- c(a,b,c,d,e)
Type <- c('Low', 'Medium', 'High', 'Super_High', 'Mega_High')
df_3 <- data$view
a = 0
b = 0
c = 0
d = 0
e = 0
for (i in df_3){
if (i <= 50000){
a = a +1
} else if (50000 <i & i <= 150000){
b = b + 1
} else if (i > 150000 & i <= 250000){
c = c + 1
} else if (i > 250000 & i <= 350000){
d = d + 1
} else{
e = e + 1
}
}
sum <- a + b + c + d + e
a <- round((a/sum)*100,2)
b <- round((b/sum)*100,2)
c <- round((c/sum)*100,2)
d <- round((d/sum)*100,2)
e <- round((e/sum)*100,2)
Type <- c('low', 'medium', 'high', 'super_high'. 'mega_high')
Percent_3 <- c(a,b,c,d,e)
a <-c(1,2,3,4,5)
data_2 <- data.frame(Type, a, Percent_2, Percent_3, Type)
data_2
## plot 2:
ggplot(data_2, aes(x = "", y =  Percent_2, fill = Type)) +
geom_col(color = "black") +
geom_label(aes(label =  Percent_2),
color = "white",
position = position_stack(vjust = 0.5),
show.legend = FALSE) +
coord_polar(theta = "y") + labs(title = 'BIEU DO VE TI LE SO TU')
